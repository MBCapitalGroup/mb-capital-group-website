<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secure Investor Portal - MB Capital Group Multifamily Syndications</title>
    <meta name="description" content="Secure investor portal for MB Capital Group syndication partners. Access investment documents, performance reports, quarterly distribution updates, and exclusive market insights." />
    <meta name="keywords" content="investor portal, multifamily syndication portal, real estate investor dashboard, investment documents, quarterly distributions, performance reports" />
    <meta name="robots" content="noindex, nofollow" />
    <link rel="canonical" href="https://mbcapitalgroup.com/investor-portal.html" />
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "MB Capital Group Investor Portal",
      "description": "Secure portal for multifamily real estate syndication investors",
      "url": "https://mbcapitalgroup.com/investor-portal.html",
      "applicationCategory": "FinanceApplication",
      "provider": {
        "@type": "Organization",
        "name": "MB Capital Group"
      }
    }
    </script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #f8fafc; color: #334155; }
        
        /* Header */
        .header { background: hsl(219, 79%, 24%); color: white; padding: 1rem 2rem; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .logo { display: flex; align-items: center; gap: 0.75rem; font-size: 1.5rem; font-weight: bold; }
        .logo img { height: 40px; width: auto; }
        .user-info { display: flex; align-items: center; gap: 1rem; }
        .logout-btn { background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: white; padding: 0.5rem 1rem; border-radius: 6px; cursor: pointer; transition: background-color 0.2s; }
        .logout-btn:hover { background: rgba(255,255,255,0.2); }
        
        /* Login Form */
        .login-container { min-height: 100vh; display: flex; align-items: center; justify-content: center; background: linear-gradient(135deg, hsl(219, 79%, 24%) 0%, hsl(219, 79%, 35%) 100%); }
        .login-form { background: white; padding: 3rem; border-radius: 12px; box-shadow: 0 20px 60px rgba(0,0,0,0.15); max-width: 400px; width: 100%; }
        .login-form h1 { color: hsl(219, 79%, 24%); margin-bottom: 0.5rem; text-align: center; }
        .login-form p { color: #64748b; text-align: center; margin-bottom: 2rem; }
        .form-group { margin-bottom: 1.5rem; }
        .form-group label { display: block; margin-bottom: 0.5rem; font-weight: 600; color: #374151; }
        .form-group input { width: 100%; padding: 0.75rem; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem; transition: border-color 0.2s; }
        .form-group input:focus { outline: none; border-color: hsl(219, 79%, 24%); }
        .login-btn { width: 100%; background: hsl(219, 79%, 24%); color: white; padding: 0.75rem; border: none; border-radius: 8px; font-size: 1rem; font-weight: 600; cursor: pointer; transition: background-color 0.2s; }
        .login-btn:hover { background: hsl(219, 79%, 20%); }
        .error-message { color: #dc2626; text-align: center; margin-top: 1rem; padding: 0.5rem; background: #fef2f2; border-radius: 6px; }
        
        /* Dashboard */
        .dashboard { max-width: 1200px; margin: 0 auto; padding: 2rem; }
        .welcome-banner { background: linear-gradient(135deg, hsl(219, 79%, 24%) 0%, hsl(219, 79%, 35%) 100%); color: white; padding: 2rem; border-radius: 12px; margin-bottom: 2rem; }
        .welcome-banner h1 { margin-bottom: 0.5rem; }
        .welcome-banner p { opacity: 0.9; }
        
        /* Stats Cards */
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; margin-bottom: 2rem; }
        .stat-card { background: white; padding: 1.5rem; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .stat-icon { width: 48px; height: 48px; background: hsl(43, 96%, 49%); border-radius: 8px; display: flex; align-items: center; justify-content: center; margin-bottom: 1rem; font-size: 1.5rem; }
        .stat-value { font-size: 2rem; font-weight: bold; color: hsl(219, 79%, 24%); margin-bottom: 0.25rem; }
        .stat-label { color: #64748b; font-size: 0.9rem; }
        
        /* Tabs */
        .tabs { background: white; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); overflow: hidden; }
        .tab-buttons { display: flex; background: #f8fafc; border-bottom: 1px solid #e2e8f0; }
        .tab-button { flex: 1; padding: 1rem; background: none; border: none; cursor: pointer; font-weight: 600; color: #64748b; transition: all 0.2s; }
        .tab-button.active { background: white; color: hsl(219, 79%, 24%); border-bottom: 3px solid hsl(43, 96%, 49%); }
        .tab-content { padding: 2rem; min-height: 400px; }
        .tab-pane { display: none; }
        .tab-pane.active { display: block; }
        
        /* Investment Cards */
        .investment-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; }
        .investment-card { background: white; border-radius: 12px; padding: 1.5rem; box-shadow: 0 2px 10px rgba(0,0,0,0.05); border: 1px solid #e2e8f0; }
        .investment-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; }
        .investment-header h3 { color: hsl(219, 79%, 24%); margin: 0; font-size: 1.1rem; }
        .investment-status { background: #10b981; color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem; font-weight: 600; }
        .investment-details { }
        .detail-row { display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid #f1f5f9; }
        .detail-row:last-child { border-bottom: none; }
        .detail-row span:first-child { color: #64748b; font-weight: 500; }
        .detail-row span:last-child { color: #1e293b; font-weight: 600; }
        .investment-title { font-size: 1.25rem; font-weight: bold; color: hsl(219, 79%, 24%); margin-bottom: 0.5rem; }
        .investment-location { color: #64748b; margin-bottom: 1rem; }
        .investment-metrics { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
        .metric { text-align: center; }
        .metric-value { font-size: 1.25rem; font-weight: bold; color: hsl(43, 96%, 49%); }
        .metric-label { font-size: 0.85rem; color: #64748b; }
        
        /* Documents */
        .document-list { display: flex; flex-direction: column; gap: 1rem; }
        .document-item { display: flex; justify-content: between; align-items: center; background: #f8fafc; padding: 1rem; border-radius: 8px; border: 1px solid #e2e8f0; }
        .document-info { flex: 1; }
        .document-name { font-weight: 600; color: hsl(219, 79%, 24%); }
        .document-meta { color: #64748b; font-size: 0.9rem; margin-top: 0.25rem; }
        .download-btn { background: hsl(43, 96%, 49%); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; transition: background-color 0.2s; }
        .download-btn:hover { background: hsl(43, 96%, 45%); }
        
        /* Communications */
        .communication-item { background: #f8fafc; padding: 1.5rem; border-radius: 8px; border-left: 4px solid hsl(43, 96%, 49%); margin-bottom: 1rem; }
        .communication-date { color: #64748b; font-size: 0.9rem; margin-bottom: 0.5rem; }
        .communication-title { font-weight: 600; color: hsl(219, 79%, 24%); margin-bottom: 0.5rem; }
        .communication-excerpt { color: #64748b; line-height: 1.6; }
        
        /* Performance Charts */
        .chart-container { background: #f8fafc; border-radius: 8px; padding: 1.5rem; margin-bottom: 1.5rem; }
        .chart-title { font-weight: 600; color: hsl(219, 79%, 24%); margin-bottom: 1rem; }
        .chart-placeholder { height: 200px; background: linear-gradient(135deg, #e2e8f0 0%, #f1f5f9 100%); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: #64748b; font-style: italic; }
        
        /* Responsive */
        @media (max-width: 768px) {
            .header { padding: 1rem; }
            .dashboard { padding: 1rem; }
            .tab-buttons { flex-direction: column; }
            .stats-grid { grid-template-columns: 1fr; }
            .investment-metrics { grid-template-columns: 1fr; }
        }
        
        /* Coming Soon Features */
        .coming-soon { text-align: center; padding: 3rem; color: #64748b; }
        .coming-soon h3 { color: hsl(219, 79%, 24%); margin-bottom: 1rem; }
        .coming-soon p { margin-bottom: 1.5rem; }
        .feature-list { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-top: 2rem; }
        .feature-item { background: #f0f9ff; padding: 1rem; border-radius: 8px; border: 1px solid #bae6fd; }
        .feature-icon { font-size: 1.5rem; margin-bottom: 0.5rem; }
        .feature-name { font-weight: 600; color: hsl(219, 79%, 24%); }
        
        /* Password Reset Styles */
        .reset-form { max-width: 400px; margin: 0 auto; }
        .reset-options { display: flex; gap: 1rem; margin-bottom: 1.5rem; }
        .reset-option { flex: 1; padding: 0.75rem; border: 2px solid #e5e7eb; border-radius: 8px; cursor: pointer; text-align: center; transition: all 0.2s; }
        .reset-option.active { border-color: hsl(219, 79%, 24%); background: hsl(219, 79%, 24%); color: white; }
        .reset-option:hover { border-color: hsl(219, 79%, 24%); }
        .back-button { background: #6b7280; color: white; border: none; padding: 0.5rem 1rem; border-radius: 6px; cursor: pointer; font-size: 0.9rem; margin-top: 1rem; }
        .back-button:hover { background: #4b5563; }
        .success-message { color: #059669; background: #d1fae5; padding: 1rem; border-radius: 6px; margin-top: 1rem; text-align: center; }
        .reset-info { background: #f0f9ff; border: 1px solid #0ea5e9; padding: 1rem; border-radius: 6px; margin-bottom: 1rem; }
        .reset-info h4 { color: hsl(219, 79%, 24%); margin-bottom: 0.5rem; }
        .reset-info ul { margin: 0.5rem 0; padding-left: 1.5rem; }
    </style>
</head>
<body>
    <!-- Login Form -->
    <div id="loginContainer" class="login-container">
        <form class="login-form" onsubmit="handleLogin(event)">
            <h1>Investor Portal</h1>
            <p>Access your investment dashboard and documents</p>
            
            <div class="form-group">
                <label for="email">Email Address</label>
                <input type="email" id="email" name="email" required>
            </div>
            
            <div class="form-group">
                <label for="password">Password</label>
                <div style="position: relative;">
                    <input type="password" id="password" name="password" required>
                    <button type="button" onclick="togglePasswordVisibility('password', 'passwordToggle')" id="passwordToggle" style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); background: none; border: none; cursor: pointer; color: #6b7280;">👁️</button>
                </div>
            </div>
            
            <button type="submit" class="login-btn">Sign In</button>
            
            <div id="errorMessage" class="error-message" style="display: none;"></div>
            
            <div style="margin-top: 1.5rem; text-align: center;">
                <button type="button" class="login-btn" onclick="showForgotPassword()" style="background: transparent; border: 1px solid hsl(219, 79%, 24%); color: hsl(219, 79%, 24%); font-size: 0.9rem; padding: 0.5rem 1rem;">
                    Forgot Password or Username?
                </button>
            </div>
            
            <div style="margin-top: 1.5rem; text-align: center; color: #64748b; font-size: 0.9rem;">
                <p>Don't have portal access yet?</p>
                <p><a href="#" onclick="showRegistration()" style="color: hsl(219, 79%, 24%);">Create Account</a> | <a href="mailto:Michael@MBCapitalGroup.com" style="color: hsl(219, 79%, 24%);">Contact Michael</a></p>
            </div>
            
            <div style="margin-top: 2rem; text-align: center; border-top: 1px solid #e2e8f0; padding-top: 1rem;">
                <a href="/" style="color: #64748b; text-decoration: none; font-size: 0.9rem; display: inline-flex; align-items: center; gap: 0.5rem;">
                    ← Return to Main Website
                </a>
            </div>
        </form>
    </div>
    
    <!-- Registration Form -->
    <div id="registrationContainer" class="login-container" style="display: none;">
        <form class="login-form" onsubmit="handleRegistration(event)">
            <h1>Create Investor Account</h1>
            <p>Get access to your investment dashboard and exclusive opportunities</p>
            
            <div class="form-group">
                <label for="regInvitationToken">Invitation Token</label>
                <input type="text" id="regInvitationToken" name="invitationToken" required placeholder="Enter the token from your invitation email">
            </div>
            
            <div class="form-group">
                <label for="regFirstName">First Name</label>
                <input type="text" id="regFirstName" name="firstName" required>
            </div>
            
            <div class="form-group">
                <label for="regLastName">Last Name</label>
                <input type="text" id="regLastName" name="lastName" required>
            </div>
            
            <div class="form-group">
                <label for="regEmail">Email Address</label>
                <input type="email" id="regEmail" name="email" required>
            </div>
            
            <div class="form-group">
                <label for="regPhone">Phone Number</label>
                <input type="tel" id="regPhone" name="phone" required>
            </div>
            
            <div class="form-group">
                <label for="regPassword">Password</label>
                <div style="position: relative;">
                    <input type="password" id="regPassword" name="password" required minlength="8">
                    <button type="button" onclick="togglePasswordVisibility('regPassword', 'regPasswordToggle')" id="regPasswordToggle" style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); background: none; border: none; cursor: pointer; color: #6b7280;">👁️</button>
                </div>
                <small style="color: #6b7280;">Must be at least 8 characters</small>
            </div>
            
            <div class="form-group">
                <label for="regConfirmPassword">Confirm Password</label>
                <div style="position: relative;">
                    <input type="password" id="regConfirmPassword" name="confirmPassword" required minlength="8">
                    <button type="button" onclick="togglePasswordVisibility('regConfirmPassword', 'regConfirmPasswordToggle')" id="regConfirmPasswordToggle" style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); background: none; border: none; cursor: pointer; color: #6b7280;">👁️</button>
                </div>
            </div>
            

            
            <button type="submit" class="login-btn">Create Account</button>
            
            <div id="registrationMessage" class="success-message" style="display: none;"></div>
            <div id="registrationError" class="error-message" style="display: none;"></div>
            
            <div style="margin-top: 1.5rem; text-align: center;">
                <button type="button" class="back-button" onclick="showLogin()">← Back to Login</button>
            </div>
            
            <div style="margin-top: 1rem; text-align: center; border-top: 1px solid #e2e8f0; padding-top: 1rem;">
                <a href="/" style="color: #64748b; text-decoration: none; font-size: 0.9rem;">
                    ← Return to Main Website
                </a>
            </div>
        </form>
    </div>
    
    <!-- Password Reset Form -->
    <div id="resetContainer" class="login-container" style="display: none;">
        <div class="login-form">
            <h1>Account Recovery</h1>
            <p>Choose how you'd like to recover your account</p>
            
            <div class="reset-options">
                <div class="reset-option active" onclick="selectResetOption('password')">
                    <strong>🔑 Reset Password</strong>
                    <p style="font-size: 0.85rem; margin-top: 0.5rem;">I know my email but forgot my password</p>
                </div>
                <div class="reset-option" onclick="selectResetOption('username')">
                    <strong>📧 Get Username</strong>
                    <p style="font-size: 0.85rem; margin-top: 0.5rem;">I forgot my username/email</p>
                </div>
            </div>
            
            <!-- Password Reset Form -->
            <form id="passwordResetForm" class="reset-form" onsubmit="handlePasswordReset(event)">
                <div class="reset-info">
                    <h4>Password Reset Process:</h4>
                    <ul>
                        <li>Enter your email address</li>
                        <li>Check your email for a secure reset link</li>
                        <li>Click the link to set a new password</li>
                        <li>Link expires in 1 hour for security</li>
                    </ul>
                </div>
                
                <div class="form-group">
                    <label for="resetEmail">Email Address</label>
                    <input type="email" id="resetEmail" name="email" required>
                </div>
                
                <button type="submit" class="login-btn">Send Reset Link</button>
                
                <div id="resetMessage" class="success-message" style="display: none;"></div>
                <div id="resetError" class="error-message" style="display: none;"></div>
            </form>
            
            <!-- Username Recovery Form -->
            <form id="usernameRecoveryForm" class="reset-form" onsubmit="handleUsernameRecovery(event)" style="display: none;">
                <div class="reset-info">
                    <h4>Username Recovery Process:</h4>
                    <ul>
                        <li>Enter your email address</li>
                        <li>We'll send your username to your email</li>
                        <li>Use the username to log in</li>
                        <li>If you also forgot your password, use the reset option</li>
                    </ul>
                </div>
                
                <div class="form-group">
                    <label for="recoveryEmail">Email Address</label>
                    <input type="email" id="recoveryEmail" name="email" required>
                </div>
                
                <button type="submit" class="login-btn">Send Username</button>
                
                <div id="recoveryMessage" class="success-message" style="display: none;"></div>
                <div id="recoveryError" class="error-message" style="display: none;"></div>
            </form>
            
            <div style="text-align: center;">
                <button type="button" class="back-button" onclick="showLogin()">← Back to Login</button>
            </div>
            
            <div style="margin-top: 1rem; text-align: center; border-top: 1px solid #e2e8f0; padding-top: 1rem;">
                <a href="/" style="color: #64748b; text-decoration: none; font-size: 0.9rem;">
                    ← Return to Main Website
                </a>
            </div>
        </div>
    </div>
    
    <!-- New Password Form (for reset token) -->
    <div id="newPasswordContainer" class="login-container" style="display: none;">
        <div class="login-form">
            <h1>Set New Password</h1>
            <p>Enter your new password below</p>
            
            <form id="newPasswordForm" class="reset-form" onsubmit="handleNewPassword(event)">
                <div class="form-group">
                    <label for="newPassword">New Password</label>
                    <input type="password" id="newPassword" name="password" required minlength="8">
                    <small style="color: #6b7280;">Must be at least 8 characters long</small>
                </div>
                
                <div class="form-group">
                    <label for="confirmPassword">Confirm New Password</label>
                    <input type="password" id="confirmPassword" name="confirmPassword" required minlength="8">
                </div>
                
                <button type="submit" class="login-btn">Update Password</button>
                
                <div id="newPasswordMessage" class="success-message" style="display: none;"></div>
                <div id="newPasswordError" class="error-message" style="display: none;"></div>
            </form>
        </div>
    </div>
    
    <!-- Dashboard -->
    <div id="dashboard" style="display: none;">
        <!-- Header -->
        <div class="header">
            <div class="logo">
                <img src="/attached_assets/Logo I think final version_1752273832987.png" alt="MB Capital Group Logo" />
                <span>Investor Portal</span>
            </div>
            <div class="user-info">
                <a href="/" style="color: white; text-decoration: none; margin-right: 1rem;">← Back to Main Site</a>
                <span id="userName">Welcome, Investor</span>
                <button class="logout-btn" onclick="logout()">Sign Out</button>
            </div>
        </div>
        
        <!-- Dashboard Content -->
        <div class="dashboard">
            <!-- Welcome Banner -->
            <div class="welcome-banner">
                <h1>Welcome to Your Investment Dashboard</h1>
                <p>Track your multifamily real estate investments, view quarterly reports, and access important documents.</p>
            </div>
            
            <!-- Stats Cards -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">💰</div>
                    <div class="stat-value">$0</div>
                    <div class="stat-label">Total Investment</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">📈</div>
                    <div class="stat-value">0%</div>
                    <div class="stat-label">Annual Return</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">🏢</div>
                    <div class="stat-value">0</div>
                    <div class="stat-label">Active Properties</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">💵</div>
                    <div class="stat-value">$0</div>
                    <div class="stat-label">Quarterly Distribution</div>
                </div>
            </div>
            
            <!-- Tabs -->
            <div class="tabs">
                <div class="tab-buttons">
                    <button class="tab-button active" onclick="showTab('investments')">My Investments</button>
                    <button class="tab-button" onclick="showTab('quarterly-reports')">Quarterly Reports</button>
                    <button class="tab-button" onclick="showTab('k1-documents')">K1 Tax Documents</button>
                    <button class="tab-button" onclick="showTab('performance')">Performance</button>
                    <button class="tab-button" onclick="showTab('communications')">Communications</button>
                </div>
                
                <div class="tab-content">
                    <!-- Investments Tab -->
                    <div id="investments" class="tab-pane active">
                        <div class="coming-soon">
                            <h3>🚀 Your Investment Portfolio</h3>
                            <p>Your multifamily real estate investments will appear here once you join a syndication.</p>
                            
                            <div class="feature-list">
                                <div class="feature-item">
                                    <div class="feature-icon">🏠</div>
                                    <div class="feature-name">Property Details</div>
                                </div>
                                <div class="feature-item">
                                    <div class="feature-icon">📊</div>
                                    <div class="feature-name">Performance Metrics</div>
                                </div>
                                <div class="feature-item">
                                    <div class="feature-icon">💰</div>
                                    <div class="feature-name">Distribution History</div>
                                </div>
                                <div class="feature-item">
                                    <div class="feature-icon">📈</div>
                                    <div class="feature-name">Appreciation Tracking</div>
                                </div>
                            </div>
                            
                            <div style="margin-top: 2rem;">
                                <a href="mailto:Michael@MBCapitalGroup.com" style="display: inline-flex; align-items: center; gap: 0.5rem; padding: 1rem 2rem; background: hsl(219, 79%, 24%); color: white; text-decoration: none; border-radius: 8px; font-weight: 600;">
                                    📧 Inquire About Current Opportunities
                                </a>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Quarterly Reports Tab -->
                    <div id="quarterly-reports" class="tab-pane">
                        <div id="quarterlyReportsContent">
                            <h3 style="color: hsl(219, 79%, 24%); margin-bottom: 1.5rem; display: flex; align-items: center; gap: 0.5rem;">
                                📊 Quarterly Reports
                            </h3>
                            <p style="color: #64748b; margin-bottom: 2rem;">
                                Access your quarterly reports for all your property investments.
                            </p>
                            <div id="quarterlyReportsContainer">
                                <div style="text-align: center; padding: 2rem; color: #64748b;">
                                    Loading quarterly reports...
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- K1 Tax Documents Tab -->
                    <div id="k1-documents" class="tab-pane">
                        <div id="k1DocumentsContent">
                            <h3 style="color: hsl(219, 79%, 24%); margin-bottom: 1.5rem; display: flex; align-items: center; gap: 0.5rem;">
                                📄 K1 Tax Documents
                            </h3>
                            <p style="color: #64748b; margin-bottom: 2rem;">
                                Download your K1 tax documents for each property investment.
                            </p>
                            <div id="k1DocumentsContainer">
                                <div style="text-align: center; padding: 2rem; color: #64748b;">
                                    Loading K1 tax documents...
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Performance Tab -->
                    <div id="performance" class="tab-pane">
                        <div class="coming-soon">
                            <h3>📈 Investment Performance</h3>
                            <p>Track the performance of your real estate investments with detailed analytics.</p>
                            
                            <div class="chart-container">
                                <div class="chart-title">Portfolio Performance Over Time</div>
                                <div class="chart-placeholder">Interactive charts will display your investment performance</div>
                            </div>
                            
                            <div class="feature-list">
                                <div class="feature-item">
                                    <div class="feature-icon">📊</div>
                                    <div class="feature-name">Cash Flow Analysis</div>
                                </div>
                                <div class="feature-item">
                                    <div class="feature-icon">📈</div>
                                    <div class="feature-name">Appreciation Trends</div>
                                </div>
                                <div class="feature-item">
                                    <div class="feature-icon">💹</div>
                                    <div class="feature-name">IRR Calculations</div>
                                </div>
                                <div class="feature-item">
                                    <div class="feature-icon">🎯</div>
                                    <div class="feature-name">vs. Projections</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Communications Tab -->
                    <div id="communications" class="tab-pane">
                        <div class="coming-soon">
                            <h3>📬 Updates & Communications</h3>
                            <p>Stay informed with property updates, market insights, and company announcements.</p>
                            
                            <div class="feature-list">
                                <div class="feature-item">
                                    <div class="feature-icon">📧</div>
                                    <div class="feature-name">Property Updates</div>
                                </div>
                                <div class="feature-item">
                                    <div class="feature-icon">📰</div>
                                    <div class="feature-name">Market Reports</div>
                                </div>
                                <div class="feature-item">
                                    <div class="feature-icon">📅</div>
                                    <div class="feature-name">Event Notifications</div>
                                </div>
                                <div class="feature-item">
                                    <div class="feature-icon">💬</div>
                                    <div class="feature-name">Direct Messaging</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Tab functionality
        function showTab(tabName) {
            // Hide all tab panes
            document.querySelectorAll('.tab-pane').forEach(pane => {
                pane.classList.remove('active');
            });
            
            // Remove active class from all buttons
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
            });
            
            // Show selected tab and activate button
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
            
            // Load data when specific tabs are selected
            if (tabName === 'quarterly-reports') {
                loadQuarterlyReports();
            } else if (tabName === 'k1-documents') {
                loadK1Documents();
            }
        }
        
        // Load quarterly reports and K1 documents
        async function loadDocuments() {
            await Promise.all([
                loadQuarterlyReports(),
                loadK1Documents()
            ]);
        }
        
        // Load quarterly reports
        async function loadQuarterlyReports() {
            try {
                const response = await fetch('/api/investor/quarterly-reports', {
                    credentials: 'include'
                });
                
                if (response.status === 401) {
                    // Not authenticated - redirect to login
                    logout();
                    showError('Session expired. Please log in again.');
                    return;
                }
                
                if (!response.ok) {
                    throw new Error('Failed to load quarterly reports');
                }
                
                const reports = await response.json();
                const container = document.getElementById('quarterlyReportsContainer');
                
                if (reports.length === 0) {
                    container.innerHTML = `
                        <div style="text-align: center; padding: 2rem; color: #64748b; background: #f8fafc; border-radius: 8px; border: 1px dashed #cbd5e1;">
                            <div style="font-size: 2rem; margin-bottom: 1rem;">📊</div>
                            <h4 style="margin-bottom: 0.5rem;">No Quarterly Reports Available</h4>
                            <p>Quarterly reports will appear here once they are published by MB Capital Group.</p>
                        </div>
                    `;
                } else {
                    container.innerHTML = reports.map(report => `
                        <div style="border: 1px solid #e2e8f0; border-radius: 8px; padding: 1.5rem; margin-bottom: 1rem; background: white;">
                            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem;">
                                <div>
                                    <h5 style="margin: 0 0 0.5rem 0; color: hsl(219, 79%, 24%); font-weight: 600;">
                                        ${report.reportTitle || 'Property Report'}
                                    </h5>
                                    <p style="margin: 0; color: #64748b; font-size: 0.9rem;">
                                        ${report.reportQuarter} ${report.reportYear}
                                    </p>
                                </div>
                                <div style="text-align: right;">
                                    <div style="background: #f0f9ff; color: #0369a1; padding: 0.25rem 0.75rem; border-radius: 4px; font-size: 0.8rem; font-weight: 500;">
                                        Published
                                    </div>
                                </div>
                            </div>
                            
                            ${report.reportSummary ? `<p style="color: #64748b; margin-bottom: 1rem; font-size: 0.9rem;">${report.reportSummary}</p>` : ''}
                            
                            <div style="display: flex; gap: 1rem; align-items: center;">
                                <a href="${report.pdfUrl}" target="_blank" 
                                   style="display: inline-flex; align-items: center; gap: 0.5rem; padding: 0.5rem 1rem; background: hsl(219, 79%, 24%); color: white; text-decoration: none; border-radius: 6px; font-size: 0.9rem; transition: background 0.3s;">
                                    📄 View Report
                                </a>
                                <span style="color: #64748b; font-size: 0.8rem;">
                                    Published: ${new Date(report.createdAt).toLocaleDateString()}
                                </span>
                            </div>
                        </div>
                    `).join('');
                }
            } catch (error) {
                console.error('Error loading quarterly reports:', error);
                document.getElementById('quarterlyReportsContainer').innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: #dc2626; background: #fee2e2; border-radius: 8px; border: 1px solid #fecaca;">
                        <div style="font-size: 2rem; margin-bottom: 1rem;">⚠️</div>
                        <h4 style="margin-bottom: 0.5rem;">Error Loading Reports</h4>
                        <p>Unable to load quarterly reports. Please try again later.</p>
                    </div>
                `;
            }
        }
        
        // Load K1 tax documents
        async function loadK1Documents() {
            try {
                const response = await fetch('/api/investor/k1-documents', {
                    credentials: 'include'
                });
                
                if (response.status === 401) {
                    // Not authenticated - redirect to login
                    logout();
                    showError('Session expired. Please log in again.');
                    return;
                }
                
                if (!response.ok) {
                    throw new Error('Failed to load K1 documents');
                }
                
                const documents = await response.json();
                const container = document.getElementById('k1DocumentsContainer');
                
                if (documents.length === 0) {
                    container.innerHTML = `
                        <div style="text-align: center; padding: 2rem; color: #64748b; background: #f8fafc; border-radius: 8px; border: 1px dashed #cbd5e1;">
                            <div style="font-size: 2rem; margin-bottom: 1rem;">📄</div>
                            <h4 style="margin-bottom: 0.5rem;">No K1 Documents Available</h4>
                            <p>K1 tax documents will appear here when they are available for download.</p>
                        </div>
                    `;
                } else {
                    container.innerHTML = documents.map(doc => `
                        <div style="border: 1px solid #e2e8f0; border-radius: 8px; padding: 1.5rem; margin-bottom: 1rem; background: white;">
                            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem;">
                                <div>
                                    <h5 style="margin: 0 0 0.5rem 0; color: hsl(219, 79%, 24%); font-weight: 600;">
                                        ${doc.fileName || 'K1 Tax Document'}
                                    </h5>
                                    <p style="margin: 0; color: #64748b; font-size: 0.9rem;">
                                        Tax Year: ${doc.taxYear}
                                    </p>
                                    <p style="margin: 0.25rem 0 0 0; color: #64748b; font-size: 0.8rem;">Property ${doc.propertyId}</p>
                                </div>
                                <div style="text-align: right;">
                                    <div style="background: #f0f9ff; color: #0369a1; padding: 0.25rem 0.75rem; border-radius: 4px; font-size: 0.8rem; font-weight: 500;">
                                        Available
                                    </div>
                                </div>
                            </div>
                            
                            <div style="display: flex; gap: 1rem; align-items: center;">
                                <a href="${doc.filePath}" target="_blank" 
                                   style="display: inline-flex; align-items: center; gap: 0.5rem; padding: 0.5rem 1rem; background: hsl(219, 79%, 24%); color: white; text-decoration: none; border-radius: 6px; font-size: 0.9rem; transition: background 0.3s;">
                                    📄 Download K1
                                </a>
                                <span style="color: #64748b; font-size: 0.8rem;">
                                    ${doc.fileName || 'Tax Document'}
                                </span>
                            </div>
                        </div>
                    `).join('');
                }
            } catch (error) {
                console.error('Error loading K1 documents:', error);
                document.getElementById('k1DocumentsContainer').innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: #dc2626; background: #fee2e2; border-radius: 8px; border: 1px solid #fecaca;">
                        <div style="font-size: 2rem; margin-bottom: 1rem;">⚠️</div>
                        <h4 style="margin-bottom: 0.5rem;">Error Loading Documents</h4>
                        <p>Unable to load K1 tax documents. Please try again later.</p>
                    </div>
                `;
            }
        }
        
        // Login functionality
        async function handleLogin(event) {
            event.preventDefault();
            const email = event.target.email.value;
            const password = event.target.password.value;
            
            if (!email || !password) {
                showError('Please enter both email and password');
                return;
            }
            
            try {
                const response = await fetch('/api/investor/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    credentials: 'include',
                    body: JSON.stringify({ email, password })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    // Store user info
                    localStorage.setItem('investorUser', JSON.stringify(data));
                    localStorage.setItem('isLoggedIn', 'true');
                    
                    // Show dashboard
                    document.getElementById('loginContainer').style.display = 'none';
                    document.getElementById('dashboard').style.display = 'block';
                    
                    // Update user name
                    document.getElementById('userName').textContent = `Welcome, ${data.firstName} ${data.lastName}`;
                    
                    // Load user data
                    loadUserData();
                } else {
                    showError(data.error || 'Login failed');
                }
            } catch (error) {
                console.error('Login error:', error);
                showError('Login failed. Please try again.');
            }
        }
        
        // Password Reset Functions
        function showForgotPassword() {
            document.getElementById('loginContainer').style.display = 'none';
            document.getElementById('resetContainer').style.display = 'flex';
        }
        
        function showLogin() {
            document.getElementById('resetContainer').style.display = 'none';
            document.getElementById('newPasswordContainer').style.display = 'none';
            document.getElementById('registrationContainer').style.display = 'none';
            document.getElementById('loginContainer').style.display = 'flex';
        }
        
        function showRegistration() {
            document.getElementById('loginContainer').style.display = 'none';
            document.getElementById('registrationContainer').style.display = 'flex';
        }
        
        async function handleRegistration(event) {
            event.preventDefault();
            const formData = new FormData(event.target);
            const data = {
                firstName: formData.get('firstName'),
                lastName: formData.get('lastName'),
                email: formData.get('email'),
                phone: formData.get('phone'),
                password: formData.get('password'),
                confirmPassword: formData.get('confirmPassword'),
                investmentAmount: formData.get('investmentAmount'),
                accreditationStatus: formData.get('accreditationStatus')
            };
            
            // Validate passwords match
            if (data.password !== data.confirmPassword) {
                showRegistrationError('Passwords do not match');
                return;
            }
            
            try {
                const response = await fetch('/api/investor/register', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });
                
                const result = await response.json();
                
                if (response.ok) {
                    showRegistrationSuccess('Account created successfully! Please wait for approval from MB Capital Group. You will receive an email notification when your account is approved.');
                    event.target.reset();
                    // Redirect to login after 3 seconds
                    setTimeout(() => {
                        showLogin();
                    }, 3000);
                } else {
                    showRegistrationError(result.error || 'Failed to create account');
                }
            } catch (error) {
                console.error('Registration error:', error);
                showRegistrationError('Failed to create account. Please try again.');
            }
        }
        
        function showRegistrationSuccess(message) {
            const successEl = document.getElementById('registrationMessage');
            const errorEl = document.getElementById('registrationError');
            
            successEl.textContent = message;
            successEl.style.display = 'block';
            errorEl.style.display = 'none';
        }
        
        function showRegistrationError(message) {
            const errorEl = document.getElementById('registrationError');
            const successEl = document.getElementById('registrationMessage');
            
            errorEl.textContent = message;
            errorEl.style.display = 'block';
            successEl.style.display = 'none';
        }
        
        function togglePasswordVisibility(inputId, toggleId) {
            const passwordInput = document.getElementById(inputId);
            const toggleButton = document.getElementById(toggleId);
            
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                toggleButton.textContent = '🙈';
                toggleButton.title = 'Hide password';
            } else {
                passwordInput.type = 'password';
                toggleButton.textContent = '👁️';
                toggleButton.title = 'Show password';
            }
        }
        
        function selectResetOption(option) {
            // Update option buttons
            document.querySelectorAll('.reset-option').forEach(opt => {
                opt.classList.remove('active');
            });
            event.target.closest('.reset-option').classList.add('active');
            
            // Show appropriate form
            if (option === 'password') {
                document.getElementById('passwordResetForm').style.display = 'block';
                document.getElementById('usernameRecoveryForm').style.display = 'none';
            } else {
                document.getElementById('passwordResetForm').style.display = 'none';
                document.getElementById('usernameRecoveryForm').style.display = 'block';
            }
        }
        
        async function handlePasswordReset(event) {
            event.preventDefault();
            const email = event.target.email.value;
            
            if (!email) {
                showResetError('resetError', 'Please enter your email address');
                return;
            }
            
            try {
                const response = await fetch('/api/investor/password-reset', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ email })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    hideResetError('resetError');
                    showResetSuccess('resetMessage', data.message);
                    event.target.reset();
                } else {
                    hideResetError('resetMessage');
                    showResetError('resetError', data.error || 'Failed to send reset email');
                }
            } catch (error) {
                console.error('Password reset error:', error);
                showResetError('resetError', 'Failed to send reset email. Please try again.');
            }
        }
        
        async function handleUsernameRecovery(event) {
            event.preventDefault();
            const email = event.target.email.value;
            
            if (!email) {
                showResetError('recoveryError', 'Please enter your email address');
                return;
            }
            
            try {
                const response = await fetch('/api/investor/username-recovery', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ email })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    hideResetError('recoveryError');
                    showResetSuccess('recoveryMessage', data.message);
                    event.target.reset();
                } else {
                    hideResetError('recoveryMessage');
                    showResetError('recoveryError', data.error || 'Failed to send username reminder');
                }
            } catch (error) {
                console.error('Username recovery error:', error);
                showResetError('recoveryError', 'Failed to send username reminder. Please try again.');
            }
        }
        
        async function handleNewPassword(event) {
            event.preventDefault();
            const newPassword = event.target.password.value;
            const confirmPassword = event.target.confirmPassword.value;
            
            if (newPassword !== confirmPassword) {
                showResetError('newPasswordError', 'Passwords do not match');
                return;
            }
            
            if (newPassword.length < 8) {
                showResetError('newPasswordError', 'Password must be at least 8 characters long');
                return;
            }
            
            const token = localStorage.getItem('resetToken');
            if (!token) {
                showResetError('newPasswordError', 'Invalid reset token. Please request a new password reset.');
                return;
            }
            
            try {
                const response = await fetch('/api/investor/password-reset/complete', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ token, newPassword })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    hideResetError('newPasswordError');
                    showResetSuccess('newPasswordMessage', data.message);
                    localStorage.removeItem('resetToken');
                    
                    // Redirect to login after 3 seconds
                    setTimeout(() => {
                        showLogin();
                    }, 3000);
                } else {
                    hideResetError('newPasswordMessage');
                    showResetError('newPasswordError', data.error || 'Failed to reset password');
                }
            } catch (error) {
                console.error('Password reset error:', error);
                showResetError('newPasswordError', 'Failed to reset password. Please try again.');
            }
        }
        
        function showResetError(elementId, message) {
            const errorEl = document.getElementById(elementId);
            errorEl.textContent = message;
            errorEl.style.display = 'block';
            errorEl.style.color = '#ef4444';
            errorEl.style.background = '#fee2e2';
        }
        
        function hideResetError(elementId) {
            const errorEl = document.getElementById(elementId);
            errorEl.style.display = 'none';
        }
        
        function showResetSuccess(elementId, message) {
            const successEl = document.getElementById(elementId);
            successEl.textContent = message;
            successEl.style.display = 'block';
        }

        // Logout functionality
        function logout() {
            localStorage.removeItem('investorUser');
            localStorage.removeItem('isLoggedIn');
            
            document.getElementById('dashboard').style.display = 'none';
            document.getElementById('loginContainer').style.display = 'flex';
            
            // Clear form
            document.getElementById('email').value = '';
            document.getElementById('password').value = '';
        }
        
        // Error handling
        function showError(message) {
            const errorDiv = document.getElementById('errorMessage');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
            
            setTimeout(() => {
                errorDiv.style.display = 'none';
            }, 5000);
        }
        
        // Load user data
        async function loadUserData() {
            try {
                const response = await fetch('/api/investor/portfolio', {
                    credentials: 'include'
                });
                
                if (response.ok) {
                    const data = await response.json();
                    updateDashboard(data);
                } else {
                    console.error('Failed to load portfolio data');
                    // Show error message in dashboard
                    updateDashboard({
                        stats: {
                            totalInvestment: 0,
                            activeProperties: 0,
                            annualReturn: 0,
                            quarterlyDistribution: 0
                        },
                        investments: []
                    });
                }
            } catch (error) {
                console.error('Error loading portfolio data:', error);
                // Show error message in dashboard
                updateDashboard({
                    stats: {
                        totalInvestment: 0,
                        activeProperties: 0,
                        annualReturn: 0,
                        quarterlyDistribution: 0
                    },
                    investments: []
                });
            }
        }

        function updateDashboard(data) {
            // Update stats cards
            const totalInvestmentEl = document.querySelector('.stat-value');
            if (totalInvestmentEl) {
                totalInvestmentEl.textContent = '$' + data.stats.totalInvestment.toLocaleString();
            }
            
            // Find and update all stat cards
            const statCards = document.querySelectorAll('.stat-card');
            if (statCards.length >= 4) {
                statCards[0].querySelector('.stat-value').textContent = '$' + data.stats.totalInvestment.toLocaleString();
                statCards[1].querySelector('.stat-value').textContent = data.stats.annualReturn + '%';
                statCards[2].querySelector('.stat-value').textContent = data.stats.activeProperties;
                statCards[3].querySelector('.stat-value').textContent = '$' + data.stats.quarterlyDistribution.toLocaleString();
            }

            // Update investments section if there are investments
            if (data.investments && data.investments.length > 0) {
                const investmentsTab = document.getElementById('investments');
                if (investmentsTab) {
                    investmentsTab.innerHTML = `
                        <div class="investment-grid">
                            ${data.investments.map(investment => `
                                <div class="investment-card">
                                    <div class="investment-header">
                                        <h3>${investment.propertyName}</h3>
                                        <span class="investment-status">Active</span>
                                    </div>
                                    <div class="investment-details">
                                        <div class="detail-row">
                                            <span>Investment Amount:</span>
                                            <span>$${parseFloat(investment.investmentAmount.toString().replace(/[$,]/g, '')).toLocaleString()}</span>
                                        </div>
                                        <div class="detail-row">
                                            <span>Equity Percentage:</span>
                                            <span>${investment.equityPercentage}%</span>
                                        </div>
                                        <div class="detail-row">
                                            <span>Investment Date:</span>
                                            <span>${new Date(investment.investmentDate).toLocaleDateString()}</span>
                                        </div>
                                        <div class="detail-row">
                                            <span>Property Address:</span>
                                            <span>${investment.propertyAddress}, ${investment.city}, ${investment.state}</span>
                                        </div>
                                        ${investment.totalUnits ? `
                                        <div class="detail-row">
                                            <span>Total Units:</span>
                                            <span>${investment.totalUnits}</span>
                                        </div>
                                        ` : ''}
                                        ${investment.targetAnnualReturn ? `
                                        <div class="detail-row">
                                            <span>Target Annual Return:</span>
                                            <span>${investment.targetAnnualReturn}</span>
                                        </div>
                                        ` : ''}
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    `;
                }
            }
        }
        
        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Check for reset token in URL or localStorage
            const resetToken = localStorage.getItem('resetToken');
            if (resetToken) {
                // Show new password form
                document.getElementById('loginContainer').style.display = 'none';
                document.getElementById('newPasswordContainer').style.display = 'flex';
                return;
            }
            
            // Check if user is already logged in
            const isLoggedIn = localStorage.getItem('isLoggedIn');
            if (isLoggedIn === 'true') {
                const userDataStr = localStorage.getItem('investorUser');
                if (userDataStr) {
                    const userData = JSON.parse(userDataStr);
                    
                    // Show dashboard
                    document.getElementById('loginContainer').style.display = 'none';
                    document.getElementById('dashboard').style.display = 'block';
                    
                    // Update user name
                    document.getElementById('userName').textContent = `Welcome, ${userData.firstName} ${userData.lastName}`;
                    
                    // Load user data
                    loadUserData();
                }
            }
        });
    </script>
</body>
</html>